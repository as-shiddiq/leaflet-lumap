<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!-- bootstrap -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
	<!-- leaflet -->
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"
	integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI="
	crossorigin=""/>
	<link rel="stylesheet" href="css/leaflet.lumap.css"/>
	<title>Luar Map</title>

	<style type="text/css">
		@import url("https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css");
		html{
			width: 100%;
			overflow-x: hidden;
		}
		#map { height: 100vh;width:100wh}
	</style>
</head>
<body>
<div class="container-fluid p-0">
<div class="row">
	<div class="col-md-3">
		<div id="lumap"></div>
	</div>
	<div class="col-md-9">
		<div id="map"></div>
	</div>
</div>
</div>

 <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"
     integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM="
     crossorigin=""></script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<script type="text/javascript" src="js/leaflet.lumap.js"></script>
<script type="text/javascript">
	let geojson = {
		"Bajuin":"#5589c0",
		"Bati_Bati":"#4f85bd", 
		"Batu_Ampar":"#4980bb", 
		"Bumi_Makmur":"#447cb8",
		"Jorong":"#4278b2",
		"Kintap":"#3f74ac",
		"Kurau":"#3d70a6",
		"Panyipatan":"#3b6ca0",
		"Pelaihari":"#2c5077",
		"Takisung":"#294c71",
		"Tambang_Ulang":"#27486b"
	};
	let map = L.map('map').setView([-3.824181, 114.8191513], 10);

	let mapboxD =  L.tileLayer('https://api.mapbox.com/styles/v1/mapbox/dark-v9/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
							attribution: 'Map data &copy; <a href=\\\"https://www.openstreetmap.org/\\\">OpenStreetMap</a> contributors,<a href=\\\"https://creativecommons.org/licenses/by-sa/2.0/\\\">CC-BY-SA</a>,Imagery © <a href=\\\"https://www.mapbox.com/\\\">Mapbox</a>',
						}).addTo(map);
	let mapboxL =  L.tileLayer('https://api.mapbox.com/styles/v1/mapbox/light-v9/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
							attribution: 'Map data &copy; <a href=\\\"https://www.openstreetmap.org/\\\">OpenStreetMap</a> contributors,<a href=\\\"https://creativecommons.org/licenses/by-sa/2.0/\\\">CC-BY-SA</a>,Imagery © <a href=\\\"https://www.mapbox.com/\\\">Mapbox</a>',
						});
	let osm = L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
	    maxZoom: 19,
	    attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
	});


	let baseMaps = {
			id:'basemap',
			title : 'BaseMaps',
			type : 'single',
			child : [
				{
					title : 'Mapbox Dark',
					iconHtml : `<img src="https://cdn-icons-png.flaticon.com/512/5088/5088218.png">`,
				    layer : mapboxD
				},
				{
					title : 'Mapbox Light',
					iconHtml : `<img src="https://cdn-icons-png.flaticon.com/512/5088/5088218.png">`,
				    layer : mapboxL
				},
				{
					title : "OpenStreetMap",
					iconHtml : `<img src="https://cdn-icons-png.flaticon.com/512/5088/5088218.png">`,
					layer : osm
				}
			]
		}
	let overlayLayers = [];
	let overlayMaps;
	let getGeojson = async () => {
		for(i in geojson)
		{
			let color = geojson[i];
			let get = await fetch(`/geojson/${i}.geojson`);
			let resp = await get.json();
			let layer = L.geoJSON(resp,{
				onEachFeature : function(f,l){
	        		l.bindPopup(f.properties.KECAMATAN);
				},
				style : {
					color: color,
				    weight:1,
				    fillOpacity:0.4,
				    dashArray:1
				}
			}).addTo(map);
			overlayLayers.push({
					    title: i.split('_').join(' '),
					    icon:'geo',
					    style:`background:${color};color:#fff`,
					    layer:layer
					});
		}
		overlayMaps = {
			id:'layers',
			title : 'Layers',
			child : overlayLayers
		};
	}

	
	getGeojson().then(()=>{
		let elLumap = document.querySelector('#lumap');
		let lumap = new Lumap(map,elLumap,[baseMaps,overlayMaps]);
	});

</script>
</body>
</html>